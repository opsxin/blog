{% extends "subject/base.html" %}

{% block title %}
<title>{{ article.title }}</title>
{% endblock title %}

{% block article %}
<article class="post post-1">
    <header class="entry-header">
        <h1 class="entry-title">{{ article.title }}</h1>
        <div class="entry-meta">
            <span class="post-category"><a
                    href="{% url 'subject:category' article.category_id %}">{{ article.category }}</a></span>
            <span class="post-date"><time class="entry-date"
                    datetime="2020-01-01T00:00:00+00:00">{{ article.modify_time }}</time></span>
            <span class="views-count">{{ article.read_num }} 阅读</span>
        </div>
    </header>
    <div class="entry-content clearfix">
        {{ article.content | safe }}
        {% if article.tags %}
        <hr>
        {% for tag in article.tags %}
        <ion-icon name="pricetag-outline" size="small"></ion-icon> <a
            href="{% url 'subject:tag' tag.id %}">{{ tag.name }}</a>
        {% endfor %}
        {% endif %}
        <hr>
        {% if pre_article.id == 0 %}
        <span class="disabled pre_article">&larr; {{ pre_article.title }}</span>
        {% else %}
        <a href="{% url 'subject:article' pre_article.id %}" class="pre_article">&larr; {{ pre_article.title }}</a>
        {% endif %}
        {% if next_article.id == 0 %}
        <span class="disabled next_article">{{ next_article.title }} &rarr;</span>
        {% else %}
        <a href="{% url 'subject:article' next_article.id %}" class="next_article">{{ next_article.title }} &rarr;</a>
        {% endif %}
    </div>
</article>
{% endblock article %}

{% block comment %}
<section class="comment-area" id="comment-area">
    <div id="gitalk-container"></div>
</section>
{% endblock comment %}

{% block directory %}
{% if article.toc %}
<div class="widget widget-content">
    <h3 class="widget-title">文章目录</h3>
    {{ article.toc | safe }}
</div>
{% endif %}
{% endblock directory %}

{% block recomment %}
{% if recomment_article %}
<div class="widget widget-recent-posts">
    <h3 class="widget-title">推荐阅读</h3>
    <ul>
        {% for article in recomment_article %}
        <li>
            <ion-icon style="padding-top: 2px;" name="document-text-outline" size="small"></ion-icon> <a
                href="{{ article.get_absolute_url }}">{{ article.title }}</a>
        </li>
        {% endfor %}
    </ul>
</div>
{% endif %}
{% endblock recomment %}

{% block resource %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/github.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>
<script
    src="https://cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.7.0/dist/highlightjs-line-numbers.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad({ singleLine: true });
</script>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: '847350f49cefd1f2326e',
        clientSecret: '3405f2c2e056abe07f587ae27cb0ade31ad033c7',
        repo: 'blog',
        owner: 'opsxin',
        admin: ['opsxin'],
        id: location.pathname,
        distractionFreeMode: false
    })

    gitalk.render('gitalk-container')
</script>
{% endblock resource %}